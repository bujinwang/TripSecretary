# 智能出入境助手 - 产品设计文档

> **核心定位**: "扫一扫证件，AI帮你过海关"  
> **首批支持**: 🇭🇰香港 | 🇹🇼台湾 | 🇹🇭泰国 | 🇺🇸美国 | 🇨🇦加拿大  
> **开发模式**: AI辅助独立开发（Vibe Coding）

---

## 一、产品概述

### 1.1 核心价值主张

为中老年朋友和追求效率的年轻人提供：
- ✅ **一次录入，永久使用** - 证件信息云端加密存储
- ✅ **智能生成入境材料** - AI自动填写各国表格
- ✅ **海关问答准备** - 双语对照，直接展示手机
- ✅ **离线可用** - 关键功能无需网络，边境WiFi也能用
- ✅ **证件遗失应急** - 高级版提供遗失指导和电子备份

### 1.2 目标用户

**主要用户群A: 中老年朋友（50-70岁）**
- 典型场景：退休旅游、探亲访友
- 核心痛点：不懂外语、担心填错表、怕海关问话
- 核心需求：操作简单、大字体、自动处理

**主要用户群B: 年轻白领（25-40岁）**
- 典型场景：商务出差、休闲旅游
- 核心痛点：重复填表麻烦、时间紧张、边境网络差
- 核心需求：快速便捷、信息复用、智能提醒、离线可用

### 1.3 支持的证件类型（MVP）

**中国大陆护照持有者：**
- 🇨🇳 中华人民共和国普通护照
- 🇭🇰 港澳通行证（往来港澳通行证）
- 🇹🇼 台湾通行证（大陆居民往来台湾通行证）

**香港特区护照持有者：**
- 🇭🇰 香港特别行政区护照（HKSAR Passport）
- 支持前往所有5个目的地（HK本地、TW、TH、USA、CA）

**关键场景覆盖：**
- ✅ 大陆居民去香港（港澳通行证）
- ✅ 大陆居民去台湾（台湾通行证 + 入台证）
- ✅ 大陆居民去泰国/美国/加拿大（中国护照 + 签证）
- ✅ 香港居民去台湾/泰国/美国/加拿大（香港护照）
- ✅ 香港居民返回香港（香港身份证）

---

## 二、核心功能流程

### 2.1 完整用户旅程（4步）

```
Step 1: 📸 扫描证件
    ↓
Step 2: 📋 补充行程信息（可选）
    ↓
Step 3: 🤖 AI生成通关包
    ↓
Step 4: 🛂 过关时展示
```

### 2.2 关键修正点

**关于材料包内容的调整：**

原设计：
```
材料包包含：
✅ 护照
✅ 签证
✅ 入境卡
✅ 机票
✅ 酒店预订
```

**新设计（修正后）：**

```
材料包分为两类：

📱 APP内生成的材料：
  ✅ 入境卡（AI自动填写）
  ✅ 海关问答卡
  ✅ 材料清单提示

📎 用户需要自备的材料：
  📌 护照（随身携带）
  📌 签证（随身携带）
  📌 机票（用户可选上传）
  📌 酒店预订（用户可选上传）
```

**高级功能（V2.0）：**
```
🆘 证件遗失应急包：
  • 护照/证件电子备份
  • 遗失处理指南
  • 大使馆联系方式
  • 紧急补办流程
  • 临时旅行证件申请
```

---

## 三、详细功能设计

### 3.1 首页：选择目的地

```
╔═══════════════════════════════════╗
║                                   ║
║      欢迎使用通关助手             ║
║                                   ║
║   您要去哪里？                    ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │  🇭🇰 香港                     │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │  🇹🇼 台湾                     │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │  🇹🇭 泰国                     │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │  🇺🇸 美国                     │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │  🇨🇦 加拿大                   │ ║
║  └─────────────────────────────┘ ║
║                                   ║
╚═══════════════════════════════════╝
```

### 3.2 扫描证件（以香港为例）

**Step 1: 扫描港澳通行证**

```
╔═══════════════════════════════════╗
║   您选择了：🇭🇰 香港               ║
╠═══════════════════════════════════╣
║                                   ║
║   请扫描您的港澳通行证            ║
║                                   ║
║  [港澳通行证示意图]               ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │                             │ ║
║  │    [📷 拍摄通行证首页]       │ ║
║  │                             │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║   💡 提示：                       ║
║   • 拍摄有照片的那一页            ║
║   • 确保光线充足，文字清晰        ║
║   • 不要反光                      ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │  [📁 从相册选择]             │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║   ⚠️ 没有港澳通行证？             ║
║   [查看如何办理]                  ║
║                                   ║
╚═══════════════════════════════════╝
```

**识别成功后：**

```
╔═══════════════════════════════════╗
║   ✓ 港澳通行证识别成功！          ║
╠═══════════════════════════════════╣
║                                   ║
║   [显示证件照片缩略图]            ║
║                                   ║
║   姓名：张伟                      ║
║   Name: ZHANG WEI                 ║
║                                   ║
║   通行证号：C12345678             ║
║   Card No: C12345678              ║
║                                   ║
║   签发地：广东省公安厅            ║
║                                   ║
║   有效期至：2028年6月15日          ║
║   Valid Until: Jun 15, 2028       ║
║                                   ║
║   ✅ 通行证有效期充足（还有3年）   ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │  信息正确  [✓ 下一步]        │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  信息有错？[📷 重新拍摄]           ║
║  手动输入？[✏️ 手动填写]           ║
║                                   ║
║  ────────────────────────          ║
║                                   ║
║  💾 是否保存证件信息？            ║
║  [ ] 云端加密保存（推荐）         ║
║      下次使用时自动识别            ║
║  [ ] 仅本次使用（不保存）         ║
║                                   ║
╚═══════════════════════════════════╝
```

### 3.3 补充行程信息（新增流程）

**关键改进：用户主动上传行程材料**

```
╔═══════════════════════════════════╗
║   📋 补充行程信息                  ║
║      (可选，但建议提供)            ║
╠═══════════════════════════════════╣
║                                   ║
║   为了生成更准确的入境材料，       ║
║   请提供以下信息：                ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │ ✈️ 往返机票                   │ ║
║  │                             │ ║
║  │ [📷 拍摄] [📁 上传] [手动填写] │ ║
║  │                             │ ║
║  │ 💡 提供机票可自动填写：       │ ║
║  │    • 航班号                  │ ║
║  │    • 出发日期                │ ║
║  │    • 返回日期                │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │ 🏨 酒店预订                   │ ║
║  │                             │ ║
║  │ [📷 拍摄] [📁 上传] [手动填写] │ ║
║  │                             │ ║
║  │ 💡 提供预订可自动填写：       │ ║
║  │    • 酒店名称和地址          │ ║
║  │    • 入住/退房日期           │ ║
║  │    • 确认号                  │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │ 📝 访问目的                   │ ║
║  │                             │ ║
║  │ • 旅游观光 ✓                │ ║
║  │ • 商务访问                   │ ║
║  │ • 探亲访友                   │ ║
║  │ • 其他（请说明）             │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  ────────────────────────          ║
║                                   ║
║  💾 信息保存选项：                ║
║  [ ] 保存行程信息以便下次使用     ║
║  [ ] 自动同步到日历               ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │  [跳过] [完成并生成]         │ ║
║  └─────────────────────────────┘ ║
║                                   ║
╚═══════════════════════════════════╝
```

**AI处理流程：**

```javascript
// 智能提取行程信息
async function processUserDocuments(images) {
  // 提取机票信息
  const flightInfo = await ocrWithAI(images.ticket);
  // 返回: { flight: "CA183", date: "2025-10-15", returnDate: "2025-10-22" }
  
  // 提取酒店信息
  const hotelInfo = await ocrWithAI(images.hotel);
  // 返回: { name: "Hong Kong Hotel", address: "...", confirmationNo: "HK2025001" }
  
  return {
    flight: flightInfo,
    hotel: hotelInfo,
    purpose: "tourism" // 用户选择
  };
}
```

### 3.4 AI生成通关包

```
╔═══════════════════════════════════╗
║   🤖 AI正在为您准备...            ║
╠═══════════════════════════════════╣
║                                   ║
║   [进度条 ████████░░ 80%]         ║
║                                   ║
║   ✓ 验证证件有效性                ║
║   ✓ 检查入境要求                  ║
║   ✓ 自动填写入境卡                ║
║   ✓ 生成海关问答（中英粤三语）     ║
║   → 准备展示界面...               ║
║                                   ║
║   预计还需 5 秒...                ║
║                                   ║
╚═══════════════════════════════════╝
```

**生成完成：**

```
╔═══════════════════════════════════╗
║   🎉 通关包已准备好！              ║
╠═══════════════════════════════════╣
║                                   ║
║   📦 您的香港通关包：              ║
║                                   ║
║   ✅ 证件验证报告                  ║
║   ✅ 海关问答卡（6个常见问题）     ║
║   ✅ 通关注意事项                  ║
║   ✅ 紧急联系方式                  ║
║                                   ║
║   ────────────                    ║
║                                   ║
║   💡 香港入境提示：                ║
║   • 不需要填写入境卡              ║
║   • 准备好通行证即可              ║
║   • 通关一般5-15分钟              ║
║                                   ║
║   📱 您需要携带的材料：            ║
║   • 港澳通行证（随身）            ║
║   • 机票（建议随身）              ║
║   • 酒店预订（建议准备）          ║
║                                   ║
║  ┌─────────────────────────────┐ ║
║  │  [👁️ 查看通关包]              │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  [📥 下载PDF备份]                  ║
║  [✉️ 发送到邮箱]                   ║
║  [🔗 分享给同行人]                 ║
║                                   ║
╚═══════════════════════════════════╝
```

### 3.5 通关展示界面（核心创新）

**首屏：证件和清单**

```
╔═══════════════════════════════════╗
║  🇭🇰 HONG KONG IMMIGRATION         ║
║     香港入境检查                   ║
╠═══════════════════════════════════╣
║                                   ║
║  [通行证照片]                     ║
║   ZHANG WEI                       ║
║   张伟                            ║
║                                   ║
║   通行证号: C12345678             ║
║   Card No: C12345678              ║
║                                   ║
║   签注: 香港个人游（G签）          ║
║   Endorsement: Individual Visit   ║
║                                   ║
╠═══════════════════════════════════╣
║  📋 需携带材料 REQUIRED DOCUMENTS  ║
╠═══════════════════════════════════╣
║                                   ║
║  ✅ 港澳通行证                     ║
║     Exit-Entry Permit             ║
║     (请随身携带)                   ║
║                                   ║
║  ✅ 往返交通凭证                   ║
║     Return Transport              ║
║     (建议准备)                     ║
║                                   ║
║  ✅ 住宿证明                       ║
║     Accommodation Proof           ║
║     (如有预订)                     ║
║                                   ║
║     All materials ready ✓         ║
║     所有材料已准备 ✓               ║
║                                   ║
╠═══════════════════════════════════╣
║                                   ║
║  👈 向左滑动查看问答卡             ║
║     Swipe left for Q&A            ║
║                                   ║
╚═══════════════════════════════════╝
```

**第二屏：问答卡**

```
╔═══════════════════════════════════╗
║  💬 常见问题 COMMON QUESTIONS      ║
╠═══════════════════════════════════╣
║                                   ║
║  Q1: 嚟做乜？/ 来做什么？          ║
║      Purpose of visit?            ║
║                                   ║
║  A:  旅遊 / 旅游 / Tourism         ║
║                                   ║
║  [点击放大此答案]                  ║
║                                   ║
║  ────────────────────────          ║
║                                   ║
║  Q2: 逗留幾耐？/ 停留多久？        ║
║      How long will you stay?      ║
║                                   ║
║  A:  7日 / 7天 / 7 days            ║
║      10月15日 - 10月22日           ║
║                                   ║
║  [点击放大此答案]                  ║
║                                   ║
║  ────────────────────────          ║
║                                   ║
║  Q3: 住邊度？/ 住哪里？            ║
║      Where will you stay?         ║
║                                   ║
║  A:  香港酒店                      ║
║      Hong Kong Hotel              ║
║      中環XX街XX號                  ║
║                                   ║
║  [显示酒店预订单]                  ║
║                                   ║
║  ────────────────────────          ║
║                                   ║
║  💡 点击任意答案可全屏展示         ║
║     方便递给海关官员查看           ║
║                                   ║
║  [查看更多问题 (6个) →]           ║
║                                   ║
╚═══════════════════════════════════╝
```

**第三屏：支持文档（可选上传）**

```
╔═══════════════════════════════════╗
║  📎 支持文件 SUPPORTING DOCS       ║
╠═══════════════════════════════════╣
║                                   ║
║  ✈️ 往返机票                       ║
║  ────────────────────────          ║
║  [您上传的机票截图]               ║
║                                   ║
║  去程: CA183, 10月15日 13:00      ║
║  Outbound: CA183, Oct 15, 13:00   ║
║                                   ║
║  回程: CA184, 10月22日 15:30      ║
║  Return: CA184, Oct 22, 15:30     ║
║                                   ║
║  [点击查看完整机票]                ║
║                                   ║
║  ────────────────────────          ║
║                                   ║
║  🏨 酒店预订                       ║
║  ────────────────────────          ║
║  [您上传的预订确认]               ║
║                                   ║
║  酒店: Hong Kong Hotel            ║
║  地址: 中環XX街XX號               ║
║  入住: 10月15日                   ║
║  退房: 10月22日                   ║
║  确认号: HK2025001                ║
║                                   ║
║  [点击查看完整预订单]              ║
║                                   ║
║  ────────────────────────          ║
║                                   ║
║  💡 这些文件已备份到云端           ║
║     即使丢失原件也可查看           ║
║                                   ║
╚═══════════════════════════════════╝
```

### 3.6 高级功能：证件遗失应急（V2.0）

```
╔═══════════════════════════════════╗
║  🆘 证件遗失应急包                 ║
║     (高级会员功能)                 ║
╠═══════════════════════════════════╣
║                                   ║
║  如果您的护照/通行证遗失：         ║
║                                   ║
║  1️⃣ 立即行动                       ║
║  ┌─────────────────────────────┐ ║
║  │ [🚨 报警] 拨打当地警察        │ ║
║  │ 香港报警电话: 999            │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  2️⃣ 查看备份                       ║
║  ┌─────────────────────────────┐ ║
║  │ [📄 查看证件电子备份]        │ ║
║  │ 您的港澳通行证副本           │ ║
║  │ (仅供应急参考)               │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  3️⃣ 联系使领馆                     ║
║  ┌─────────────────────────────┐ ║
║  │ 中国外交部驻港公署           │ ║
║  │ 电话: +852 3413 2300        │ ║
║  │ 地址: 香港湾仔...            │ ║
║  │ [📞 一键拨打] [📍 导航前往]  │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  4️⃣ 补办指南                       ║
║  ┌─────────────────────────────┐ ║
║  │ [📖 查看详细补办流程]        │ ║
║  │ • 需要的材料清单             │ ║
║  │ • 办理地点和时间             │ ║
║  │ • 费用说明                   │ ║
║  │ • 预计办理时长               │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  5️⃣ 临时旅行证                     ║
║  ┌─────────────────────────────┐ ║
║  │ [📝 申请临时旅行证件]        │ ║
║  │ 用于紧急回国                 │ ║
║  └─────────────────────────────┘ ║
║                                   ║
║  ────────────────────────          ║
║                                   ║
║  💡 预防建议：                     ║
║  • 出行前拍照备份                 ║
║  • 证件和现金分开存放             ║
║  • 使用APP云端备份功能            ║
║                                   ║
╚═══════════════════════════════════╝
```

---

## 四、AI技术栈（2025年10月最新）

### 4.1 核心模型选择

| 功能 | 主力模型 | 备选方案 | 成本 | 场景 |
|------|---------|---------|------|------|
| **证件分析** | Claude Sonnet 4.5 | GPT-5 | $3/$15/M | 复杂证件 |
| **快速OCR** | GPT-5 | GPT-4o | $1.25/$5/M | 简单识别 |
| **专业OCR** | Google Cloud Vision | - | $1.5/1k | 准确率要求高 |
| **本地OCR** | PaddleOCR v4 | - | 免费 | 隐私/离线 |
| **翻译** | DeepL Pro | GPT-5 | $5.49/M chars | 正式文件 |

### 4.2 智能路由策略

```javascript
// 降低70%成本的路由算法
class AIRouter {
  async route(task, destination) {
    // 场景1: 简单证件识别
    if (task === 'simple_ocr' && destination in ['HK', 'TW']) {
      return {
        model: 'paddleocr', // 本地免费
        fallback: 'gpt-4o', // 失败后用云端
        cost: '$0'
      };
    }
    
    // 场景2: 复杂证件分析（美国）
    if (task === 'complex_analysis' && destination === 'USA') {
      return {
        model: 'claude-sonnet-4-5',
        reason: '美国规则最复杂，需要最强推理',
        cost: '$0.08',
        enableCaching: true // 省90%
      };
    }
    
    // 场景3: 生成入境表格
    if (task === 'generate_form') {
      return {
        model: 'claude-sonnet-4-5',
        reason: '结构化输出最佳',
        cost: '$0.05',
        cacheTemplate: true // 缓存表格模板
      };
    }
    
    // 场景4: 实时翻译
    if (task === 'translation') {
      return {
        model: 'gpt-5',
        verbosity: 'low', // 简短输出
        cost: '$0.001'
      };
    }
  }
}
```

### 4.3 成本优化技巧

**Prompt Caching（Claude专属）：**
```javascript
// 缓存常用内容，省90%成本
const prompt = {
  system: [
    {
      type: "text",
      text: "各国入境规则...", // 这部分会被缓存
      cache_control: { type: "ephemeral" }
    }
  ],
  messages: [
    {
      role: "user",
      content: `验证用户信息: ${userInfo}` // 每次变化的部分
    }
  ]
};

// 首次调用: $0.05
// 后续调用: $0.005（省90%）
```

**本地预处理策略：**
```javascript
// 70%的证件可以用免费的PaddleOCR识别
async function smartOCR(image) {
  // 1. 先用本地PaddleOCR（免费）
  const localResult = await paddleOCR.recognize(image);
  
  // 2. 如果置信度高，直接返回
  if (localResult.confidence > 0.95) {
    return { data: localResult, cost: 0 };
  }
  
  // 3. 置信度低，使用云端API
  const cloudResult = await googleVision.recognize(image);
  return { data: cloudResult, cost: 0.0015 };
}

// 平均成本: $0.0015 × 30% = $0.00045
```

---

## 五、各地区详细处理流程

### 5.1 香港 🇭🇰

**证件要求：**
- 港澳通行证 + 有效签注
- 或护照（某些情况）

**特点：**
- ✅ 最简单：无需填入境卡
- ✅ 通关快：5-15分钟
- ✅ 语言：粤语、英语、普通话都通用

**AI处理流程：**
```javascript
async function processHongKong(images, userInfo) {
  // 1. OCR识别通行证（本地优先）
  const permit = await smartOCR(images.permit);
  const endorsement = await smartOCR(images.endorsement);
  
  // 2. GPT-5快速验证
  const validation = await gpt5.validate({
    permit: permit,
    endorsement: endorsement,
    checkPoints: [
      "通行证有效期",
      "签注有效期",
      "签注剩余次数"
    ]
  });
  
  // 3. 生成三语问答卡
  const qaCard = await gpt5.generate({
    type: 'qa_card',
    languages: ['yue', 'zh-CN', 'en'], // 粤语/普通话/英语
    questions: [
      "访问目的",
      "停留时间",
      "住宿地点",
      "返程方式"
    ]
  });
  
  // 4. 组装通关包
  return {
    destination: 'Hong Kong',
    validation: validation,
    qaCard: qaCard,
    requiredDocuments: [
      "港澳通行证（随身）",
      "往返交通凭证（建议准备）",
      "住宿证明（如有预订）"
    ],
    tips: [
      "无需填写入境卡",
      "通关速度快",
      "可使用e-道自助通关"
    ]
  };
}
```

### 5.2 台湾 🇹🇼

**证件要求：**
- 大陆居民往来台湾通行证（大通证）
- 台湾地区入出境许可证（入台证）

**特点：**
- ⭐ 需要填写繁体入境表
- ⭐ 两证缺一不可
- ⭐ 语言：繁体中文为主

**AI处理流程：**
```javascript
async function processTaiwan(images, userInfo) {
  // 1. 识别大通证和入台证
  const mainlandPermit = await smartOCR(images.permit);
  const entryPermit = await smartOCR(images.entryPermit);
  
  // 2. Claude生成繁体入境表
  const arrivalCard = await claudeSonnet45.generate({
    prompt: `
      生成台湾入境登记表（繁体中文）
      
      用户信息：
      - 姓名：${mainlandPermit.name}
      - 大通证号：${mainlandPermit.number}
      - 入台证号：${entryPermit.number}
      - 出生日期：${mainlandPermit.dob}
      
      行程信息：
      - 航班：${userInfo.flight}
      - 酒店：${userInfo.hotel}
      - 停留天数：${userInfo.duration}
      
      要求：
      1. 完整的繁体中文表格
      2. 简体中文对照（括号内）
      3. 英文翻译
      4. 填写注意事项
      
      返回JSON格式，包含所有字段：
      - 姓名 (Name)
      - 大通證號碼 (Permit No)
      - 入臺證號 (Entry Permit No)
      - 來臺目的 (Purpose)
      - 停留天數 (Duration)
      - 在臺住址 (Address in Taiwan)
      - 聯絡電話 (Contact Number)
    `,
    maxTokens: 4000,
    caching: true // 缓存模板
  });
  
  // 3. 生成三语问答卡
  const qaCard = await gpt5.generate({
    languages: ['zh-TW', 'zh-CN', 'en'],
    questions: [
      "來臺目的 / 来台目的 / Purpose",
      "停留時間 / 停留时间 / Duration",
      "住宿地點 / 住宿地点 / Accommodation",
      "職業 / 职业 / Occupation"
    ]
  });
  
  return {
    destination: 'Taiwan',
    arrivalCard: arrivalCard, // ⭐ 这是核心价值
    qaCard: qaCard,
    requiredDocuments: [
      "大通证（随身）",
      "入台证（随身，打印或电子版）",
      "往返机票（必须准备）",
      "住宿证明（建议准备）"
    ],
    tips: [
      "需要填写入境表，APP已帮您生成",
      "可直接出示手机或打印签名",
      "入台证务必保存好"
    ]
  };
}
```

### 5.3 泰国 🇹🇭

**证件要求：**
- 护照（有效期≥6个月）
- 签证或落地签

**特点：**
- ⭐ 需要填写泰文TM.6入境卡
- ⭐ 泰英双语环境
- ⭐ 对现金携带有要求

**AI处理流程：**
```javascript
async function processThailand(images, userInfo) {
  // 1. 识别护照和签证
  const passport = await googleVision(images.passport); // 泰国签证复杂
  const visa = await googleVision(images.visa);
  
  // 2. Claude验证（泰国规则较多）
  const validation = await claudeSonnet45.validate({
    prompt: `
      验证泰国入境要求：
      
      护照信息：
      - 护照号：${passport.number}
      - 有效期：${passport.expiry}
      - 国籍：${passport.nationality}
      
      签证信息：
      - 类型：${visa.type}
      - 有效期：${visa.validity}
      - 停留天数：${visa.duration}
      
      今天：${new Date().toISOString()}
      
      检查：
      1. 护照有效期是否≥6个月 ⭐
      2. 签证是否在有效期内
      3. 停留时间是否符合
      4. 现金要求（个人20,000泰铢，家庭40,000泰铢）
      
      返回详细验证报告
    `,
    caching: true
  });
  
  // 3. Claude生成泰文入境卡
  const tm6Card = await claudeSonnet45.generate({
    prompt: `
      生成泰国TM.6入境卡（Arrival/Departure Card）
      
      用户信息：
      - 姓名：${passport.fullName}
      - 护照号：${passport.number}
      - 国籍：${passport.nationality}
      - 出生日期：${passport.dob}
      
      行程信息：
      - 航班：${userInfo.flight}
      - 酒店：${userInfo.hotel}
      - 停留天数：${userInfo.duration}
      
      生成完整TM.6表格，包括：
      1. 泰文字段名称
      2. 英文对照
      3. 中文说明
      4. 预填的用户信息
      
      标准字段：
      - ชื่อ (Name / 姓名)
      - หนังสือเดินทาง (Passport / 护照)
      - วัตถุประสงค์ (Purpose / 目的)
      - ระยะเวลา (Duration / 停留时间)
      - ที่พัก (Address / 住址)
      - วันเดินทาง (Travel Date / 出发日期)
      
      返回JSON格式
    `,
    maxTokens: 5000
  });
  
  // 4. 翻译和问答
  const qaCard = await gpt5.generate({
    languages: ['th', 'en', 'zh'],
    specialQuestions: [
      "วัตถุประสงค์ / Purpose / 目的",
      "จำนวนเงิน / Cash / 携带现金", // ⭐ 泰国特别关注
      "ที่พัก / Hotel / 住宿",
      "อาชีพ / Occupation / 职业"
    ]
  });
  
  return {
    destination: 'Thailand',
    validation: validation,
    arrivalCard: tm6Card,
    qaCard: qaCard,
    requiredDocuments: [
      "护照（随身，有效期≥6个月）",
      "签证（随身）",
      "往返机票（必须准备）",
      "酒店预订（建议准备）",
      "现金20,000泰铢或等值外币（个人）" // ⭐ 重要
    ],
    tips: [
      "TM.6入境卡APP已生成，可打印或手机展示",
      "务必携带足够现金，海关可能抽查",
      "保留出境卡，离境时需要"
    ]
  };
}
```

### 5.4 美国 🇺🇸（最复杂）

**证件要求：**
- 护照（有效期建议≥6个月）
- 有效美国签证或ESTA

**特点：**
- ⭐⭐⭐ 最复杂：规则多、审查严
- ⭐⭐⭐ CBP问询详细
- ⭐⭐⭐ 需要I-94

**AI处理流程：**
```javascript
async function processUSA(images, userInfo) {
  // 1. 高精度OCR
  const passport = await googleVision(images.passport);
  const visa = await googleVision(images.visa);
  
  // 2. Claude深度分析（美国需要最强推理）
  const deepAnalysis = await claudeSonnet45.analyze({
    prompt: `
      深度分析美国入境要求（这是最复杂的任务）
      
      护照信息：
      - 护照号：${passport.number}
      - 有效期：${passport.expiry}
      - 国籍：${passport.nationality}
      
      签证信息：
      - 类型：${visa.category} (B1/B2/F1/H1B/J1等)
      - 签证号：${visa.number}
      - 有效期：${visa.validity}
      - 入境次数：${visa.entries}
      - 注解：${visa.annotations} ⭐ 很重要
      
      用户背景：
      - 职业：${userInfo.occupation}
      - 访问目的：${userInfo.purpose}
      - 停留时间：${userInfo.duration}
      
      请详细分析：
      
      1. 签证类型详解
         - 这是什么签证（旅游/商务/学生/工作）
         - 允许的活动范围
         - 不允许做什么
      
      2. 入境限制
         - 允许入境次数
         - 每次停留时长
         - 有效期计算
      
      3. 配套文件要求
         - I-20表格（F1学生）
         - DS-2019（J1交流）
         - 雇主信（B1商务/H1B工作）
         - 资金证明
         - 行程计划
      
      4. CBP关注重点
         - 会重点询问什么
         - 需要准备什么证据
         - 常见拒入理由
      
      5. 风险评估
         - 潜在的问题点
         - 如何规避
         - 应急预案
      
      请给出详细的JSON报告，包含：
      - visaType: 签证类型
      - restrictions: 限制条件
      - requiredDocs: 必备文件清单
      - cbpFocus: CBP关注点
      - risks: 风险评估
      - suggestions: 建议
    `,
    maxTokens: 8000, // 美国分析需要更多token
    caching: true // 缓存分析框架
  });
  
  // 3. 针对性生成CBP问答
  const cbpQA = await claudeSonnet45.generate({
    prompt: `
      根据以下分析，生成CBP海关问答准备：
      
      ${JSON.stringify(deepAnalysis)}
      
      生成15-20个最可能被问到的问题，按重要性排序。
      
      每个问题包含：
      1. 英文原文
      2. 中文翻译
      3. 建议回答（简短、诚实）
      4. 需要出示的文件（如有）
      5. 回答技巧
      
      特殊场景：
      - 第一次入境美国
      - 敏感职业（程序员/研究员）
      - 长时间停留
      - 单身年轻人
      
      返回JSON格式
    `,
    maxTokens: 6000
  });
  
  // 4. 生成材料清单
  const checklist = await gpt5.generate({
    type: 'us_checklist',
    visaType: deepAnalysis.visaType,
    includeOptional: true
  });
  
  return {
    destination: 'United States',
    analysis: deepAnalysis, // ⭐ 深度分析报告
    cbpQA: cbpQA, // ⭐ CBP问答准备
    checklist: checklist,
    requiredDocuments: [
      "护照（随身）",
      "美国签证（随身）",
      "I-94确认单（在线填写或入境时获取）",
      "往返机票（必须准备）",
      ...deepAnalysis.requiredDocs // 根据签证类型动态添加
    ],
    warnings: deepAnalysis.risks,
    tips: [
      "CBP问询可能较详细，请如实回答",
      "准备好支持性文件",
      "保持礼貌和耐心",
      "不确定的问题可以说'I need to check'",
      "切勿隐瞒或撒谎"
    ]
  };
}
```

### 5.5 加拿大 🇨🇦

**证件要求：**
- 护照（有效期建议≥6个月）
- 签证或eTA（电子旅行许可）

**特点：**
- ⭐ 双语国家（英法）
- ⭐ 需要申报物品
- ⭐ eTA在线申请

**AI处理流程：**
```javascript
async function processCanada(images, userInfo) {
  // 1. 识别证件
  const passport = await smartOCR(images.passport);
  const visa = await smartOCR(images.visa);
  
  // 2. GPT-5验证
  const validation = await gpt5.validate({
    passport: passport,
    visa: visa,
    checkETA: true, // 检查是否需要eTA
    destination: 'Canada'
  });
  
  // 3. Claude生成入境申报卡
  const declarationCard = await claudeSonnet45.generate({
    prompt: `
      生成加拿大入境申报卡（Declaration Card）
      
      用户信息：
      - 姓名：${passport.fullName}
      - 护照号：${passport.number}
      - 国籍：${passport.nationality}
      
      行程信息：
      - 航班：${userInfo.flight}
      - 停留时长：${userInfo.duration}
      - 住址：${userInfo.address}
      
      申报信息：
      - 携带现金：${userInfo.cash}
      - 携带物品：${userInfo.items}
      
      生成完整申报卡，包括：
      1. 英文字段
      2. 法语对照
      3. 中文说明
      
      重要字段：
      - Purpose of visit
      - Length of stay
      - Goods to declare
      - Amount of currency
      
      返回JSON格式
    `
  });
  
  // 4. 双语问答卡
  const qaCard = await gpt5.generate({
    languages: ['en', 'fr', 'zh'],
    questions: [
      "Purpose / Objectif / 目的",
      "Duration / Durée / 停留时间",
      "Address / Adresse / 住址",
      "Items to declare / Articles à déclarer / 申报物品"
    ]
  });
  
  return {
    destination: 'Canada',
    validation: validation,
    declarationCard: declarationCard,
    qaCard: qaCard,
    requiredDocuments: [
      "护照（随身）",
      "签证或eTA确认（随身）",
      "往返机票（建议准备）",
      "住宿证明（建议准备）"
    ],
    tips: [
      "如需eTA，请提前在线申请",
      "诚实申报携带物品",
      "加拿大重视诚信，切勿隐瞒",
      "英法双语都可使用"
    ]
  };
}
```

---

## 六、用户界面设计原则

### 6.1 针对中老年用户

**核心原则：**
1. ✅ 超大字体（标题28pt，正文20pt）
2. ✅ 高对比度（黑白为主）
3. ✅ 大按钮（最小60×60pt）
4. ✅ 简化操作（每屏1-2个主要操作）
5. ✅ 进度明确（1/4, 2/4, 3/4, 4/4）

**示例：**
```
标题字体: 28pt, Bold
正文字体: 20pt, Regular
辅助文字: 16pt, Light

按钮尺寸: 80pt × 60pt
按钮间距: ≥16pt

颜色方案:
- 背景: #FFFFFF (纯白)
- 主文字: #000000 (纯黑)
- 辅助文字: #666666 (深灰)
- 强调色: #0066CC (蓝色)
- 警告色: #FF9900 (橙色)
- 成功色: #00AA00 (绿色)
```

### 6.2 横屏展示模式

当用户需要展示给海关官员时：

```
检测横屏 → 自动切换布局
        ↓
    ┌────────────────────────────┐
    │  超大字体                  │
    │  内容居中                  │
    │  去除多余元素              │
    │  官方风格                  │
    └────────────────────────────┘
```

**横屏界面示例：**
```
╔════════════════════════════════════════════════════════╗
║                                                        ║
║             IMMIGRATION DOCUMENT                       ║
║                 入境文件                               ║
║                                                        ║
║  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  ║
║                                                        ║
║   Name: ZHANG WEI                                      ║
║   姓名: 张伟                                           ║
║                                                        ║
║   Passport No: E12345678                               ║
║   护照号: E12345678                                    ║
║                                                        ║
║   Purpose: Tourism                                     ║
║   目的: 旅游                                           ║
║                                                        ║
║   Duration: 7 days                                     ║
║   停留: 7天                                            ║
║                                                        ║
║  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  ║
║                                                        ║
║             All documents verified ✓                   ║
║             所有文件已验证 ✓                           ║
║                                                        ║
╚════════════════════════════════════════════════════════╝
```

### 6.3 答案放大模式

点击任意答案后：

```
╔═══════════════════════════════════╗
║                                   ║
║                                   ║
║           Tourism                 ║
║           旅游                    ║
║                                   ║
║           观光                    ║
║                                   ║
║                                   ║
║      [点击屏幕关闭]                ║
║                                   ║
╚═══════════════════════════════════╝
```

字体大小：**48pt - 60pt**，整屏显示一个答案。

---

## 七、技术实现方案

### 7.1 技术栈

**前端 App（离线优先架构）:**
```
React Native + Expo
├── UI库: NativeWind (Tailwind)
├── 状态管理: Zustand + Persist
├── 导航: React Navigation
├── 本地存储: 
│   ├── AsyncStorage (用户设置)
│   ├── SQLite (证件数据、政策库)
│   └── MMKV (高性能缓存)
├── 离线能力:
│   ├── @react-native-community/netinfo (网络状态)
│   ├── Redux Offline (离线队列)
│   └── Service Worker (PWA支持)
├── 相机: expo-camera
└── 文件系统: expo-file-system
```

**后端（Serverless + 离线同步）:**
```
Cloudflare Workers + D1 + KV + R2
├── 数据库: Cloudflare D1 (SQLite分布式，在线同步)
├── 认证: 
│   ├── 微信 OAuth (主要方式) ⭐
│   ├── 手机号 + SMS (备选)
│   └── Workers API (自建认证)
├── 缓存: Cloudflare KV (翻译、政策库)
├── 存储: Cloudflare R2 (文件存储，加密)
├── API: Cloudflare Workers (全球边缘节点)
└── 离线优先:
    ├── 本地SQLite优先读取
    ├── 后台同步队列
    └── 冲突解决策略
```

**AI服务（国产AI为主）:**
```
核心LLM（国产AI）:
├── 阿里通义千问 Qwen-Max (主力) ⭐
│   - 中国完全可用
│   - 中文能力强
│   - 价格便宜50%
│   - ¥0.04/1k tokens
│
├── 百度文心一言 ERNIE 4.0 (备用)
│   - 百度出品，稳定
│   - ¥0.024/1k tokens
│
└── 智谱AI GLM-4 (备选)
    - 清华出品
    - ¥0.05/1k tokens

OCR（离线优先）:
├── PaddleOCR (本地 - 优先使用) ⭐
│   - 完全离线
│   - 免费
│   - 准确率95%+
│
├── 阿里云OCR (云端 - 高精度场景)
│   - 国内可用
│   - ¥0.15/次
│   - 准确率99%+
│
└── 腾讯云OCR (备用)
    - 国内可用
    - ¥0.15/次

翻译（缓存优先）:
├── 本地翻译缓存库 (常见短语) ⭐
│   - 完全离线
│   - 0ms响应
│   - 覆盖100%常用场景
│
├── 百度翻译API (在线动态翻译)
│   - 国内可用
│   - ¥49/100万字符
│   - 200+语言
│
└── 阿里机器翻译 (备用)
    - 国内可用
    - ¥50/100万字符

离线AI能力:
├── TensorFlow Lite (本地模型)
├── ONNX Runtime (跨平台推理)
└── 预生成模板库 (5国×100+问答)
```

**关键优势：**
- ✅ 100%在中国可用（不依赖翻墙）
- ✅ 响应速度快（服务器在国内）
- ✅ 成本低50%（比国际AI便宜）
- ✅ 完全合规（符合监管要求）
- ✅ 中文能力强（专为中文优化）

**网络策略:**
```
智能网络管理:
├── WiFi检测与优化
├── 弱网降级策略
├── 离线队列管理
└── 断点续传

数据预下载:
├── 首次启动下载所有政策
├── 入境表格模板
├── 常见问答库
└── 翻译短语库
```

**开发工具:**
```
├── Cursor (AI代码编辑器)
├── GitHub Copilot
├── v0.dev (UI快速生成)
└── Midjourney (图标设计)
```

### 7.2 数据库设计

**核心表结构：**

```sql
-- 用户表
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email TEXT UNIQUE,
  created_at TIMESTAMP DEFAULT NOW(),
  subscription_tier TEXT DEFAULT 'free', -- free/pro/premium
  preferences JSONB -- 用户偏好设置
);

-- 证件信息表（加密存储）
CREATE TABLE documents (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  type TEXT NOT NULL, -- passport/hk_permit/tw_permit
  encrypted_data TEXT NOT NULL, -- 加密后的证件信息
  expiry_date DATE,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- 行程记录表
CREATE TABLE trips (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  destination TEXT NOT NULL, -- HK/TW/TH/USA/CA
  departure_date DATE,
  return_date DATE,
  status TEXT DEFAULT 'planned', -- planned/completed/cancelled
  travel_package JSONB, -- 生成的通关包
  created_at TIMESTAMP DEFAULT NOW()
);

-- 上传的文件表
CREATE TABLE user_files (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  trip_id UUID REFERENCES trips(id),
  file_type TEXT NOT NULL, -- ticket/hotel/other
  file_url TEXT NOT NULL, -- Cloudflare R2存储URL
  extracted_data JSONB, -- OCR提取的信息
  created_at TIMESTAMP DEFAULT NOW()
);

-- 政策库表
CREATE TABLE entry_policies (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  country_code TEXT NOT NULL,
  policy_data JSONB NOT NULL, -- 入境政策详情
  last_updated TIMESTAMP DEFAULT NOW(),
  version INTEGER DEFAULT 1
);

-- 使用记录表（用于统计和优化）
CREATE TABLE usage_logs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  action TEXT NOT NULL, -- ocr/generate/translate
  destination TEXT,
  ai_model TEXT, -- 使用的AI模型
  cost DECIMAL(10, 6), -- 成本
  success BOOLEAN,
  created_at TIMESTAMP DEFAULT NOW()
);
```

### 7.3 API端点设计

```javascript
// API Routes

// 1. 证件识别
POST /api/ocr/document
Request: { image: base64, type: 'passport|permit' }
Response: { 
  success: true, 
  data: { name, number, expiry, ... },
  confidence: 0.98
}

// 2. 智能验证
POST /api/validate/entry
Request: { 
  document: {...}, 
  destination: 'HK|TW|TH|USA|CA' 
}
Response: { 
  valid: true, 
  warnings: [...],
  requirements: [...]
}

// 3. 生成通关包
POST /api/generate/package
Request: { 
  user: {...}, 
  documents: [...],
  trip: {...}
}
Response: { 
  arrivalCard: {...},
  qaCard: {...},
  checklist: [...],
  tips: [...]
}

// 4. 上传文件
POST /api/upload/file
Request: { file: FormData, type: 'ticket|hotel' }
Response: { 
  fileId: 'xxx', 
  url: 'https://...', 
  extractedData: {...}
}

// 5. 实时翻译
POST /api/translate/text
Request: { 
  text: 'Do you have...', 
  from: 'en', 
  to: 'zh' 
}
Response: { 
  translation: '你有...', 
  alternatives: [...]
}
```

### 7.4 安全与隐私

**数据加密：**
```javascript
// 证件信息端到端加密
import { encrypt, decrypt } from '@/lib/crypto';

// 上传时加密
const encrypted = await encrypt(documentData, userKey);
await env.DB.prepare(
  'INSERT INTO documents (user_id, encrypted_data) VALUES (?, ?)'
).bind(userId, encrypted).run();

// 读取时解密
const data = await env.DB.prepare(
  'SELECT encrypted_data FROM documents WHERE user_id = ?'
).bind(userId).first();
  
const decrypted = await decrypt(data.encrypted_data, userKey);
```

**访问控制：**
```javascript
// Application-level access control in Cloudflare Workers

export default {
  async fetch(request, env) {
    // 验证JWT token
    const userId = await verifyToken(request.headers.get('Authorization'));
    
    // 确保用户只能访问自己的数据
    const data = await env.DB.prepare(
      'SELECT * FROM documents WHERE user_id = ?'
    ).bind(userId).all();
    
    return new Response(JSON.stringify(data));
  }
};
```

**敏感数据处理：**
- 证件照片：上传后立即加密，使用Cloudflare R2 Storage
- 护照号码：前端脱敏显示（E123****78）
- 用户密钥：存储在设备Keychain/Keystore
- API密钥：使用Cloudflare环境变量，不硬编码

---

## 八、开发时间线（6个月）

### Month 1: 基础框架 + 香港/台湾

**Week 1-2: 项目搭建**
- [x] 创建React Native + Expo项目
- [x] 配置Cloudflare Workers + D1后端
- [x] 设置开发环境
- [x] UI组件库搭建
- [x] 导航结构设计

**Week 3-4: OCR功能**
- [x] 集成PaddleOCR (本地)
- [x] 集成Google Cloud Vision (云端)
- [x] 实现智能路由OCR
- [x] 港澳通行证识别测试
- [x] 台湾通行证识别测试

**交付物：**
✅ 香港、台湾证件识别
✅ 基础UI界面
✅ 用户注册登录

---

### Month 2: 泰国 + 优化

**Week 5-6: 泰国功能**
- [ ] 护照OCR识别
- [ ] 泰国签证识别
- [ ] TM.6表格生成
- [ ] 泰英中三语处理
- [ ] DeepL翻译集成

**Week 7-8: UI优化**
- [ ] 大字体模式
- [ ] 横屏展示模式
- [ ] 答案放大功能
- [ ] 离线功能
- [ ] 缓存优化

**交付物：**
✅ 前3个地区完整功能
✅ 用户体验优化

---

### Month 3: 美国 + 加拿大

**Week 9-10: 美国功能**
- [ ] 复杂签证分析
- [ ] CBP深度问答准备
- [ ] 高精度验证流程
- [ ] 风险评估系统
- [ ] I-94信息整合

**Week 11-12: 加拿大功能**
- [ ] eTA验证
- [ ] 入境申报卡生成
- [ ] 英法双语支持
- [ ] 完整测试

**交付物：**
✅ 全部5个地区支持
✅ 完整功能MVP

---

### Month 4: 测试 + 优化

**Week 13-14: 内部测试**
- [ ] Bug修复
- [ ] 性能优化
- [ ] AI成本优化（Prompt Caching）
- [ ] 安全审计
- [ ] 数据库优化

**Week 15-16: 用户测试**
- [ ] 招募50名测试用户
  - 25名中老年用户
  - 25名年轻用户
- [ ] 收集反馈
- [ ] 迭代优化
- [ ] 准备上线材料

**交付物：**
✅ 稳定的MVP版本
✅ 用户满意度≥4.5/5

---

### Month 5-6: 上线 + 推广

**Week 17-20: 应用商店上线**
- [ ] iOS App Store提交
- [ ] Android Play Store提交
- [ ] 应用宝提交（国内）
- [ ] 准备宣传素材
- [ ] 制作用户手册

**Week 21-24: 推广获客**
- [ ] 社交媒体营销
  - 小红书种草
  - 抖音短视频
  - B站UP主合作
- [ ] 旅行社合作
- [ ] 论坛推广
- [ ] SEO优化

**目标：**
✅ 上线所有主流应用商店
✅ 获取1000+注册用户
✅ 300+付费用户
✅ 月收入¥15,000

---

## 九、商业模式

### 9.1 定价策略

| 版本 | 价格 | 功能 | 目标用户 |
|------|------|------|---------|
| **免费版** | ¥0 | • 支持1个国家<br/>• 基础OCR识别<br/>• 简单验证<br/>• 有广告 | 试用用户 |
| **单次通行证** | ¥19/次 | • 支持1个国家<br/>• 完整通关包<br/>• 48小时有效<br/>• 无广告 | 偶尔出国 |
| **年度会员** | ¥98/年 | • 支持所有5国<br/>• 无限次使用<br/>• 云端备份<br/>• 优先客服 | 频繁出国 |
| **家庭套餐** | ¥168/年 | • 支持所有5国<br/>• 最多5位家人<br/>• 共享材料<br/>• 家庭管理 | 全家旅游 |
| **高级会员** | ¥198/年 | • 所有会员功能<br/>• 证件遗失应急<br/>• 紧急客服热线<br/>• 优先更新 | 重度用户 |

### 9.2 收入预测

**第一年（保守估计）：**

| 月份 | 免费用户 | 付费用户 | 转化率 | 月收入 | 累计收入 |
|------|---------|---------|--------|--------|---------|
| M1-3 | 500 | 20 | 4% | ¥980 | ¥2,940 |
| M4-6 | 2,000 | 100 | 5% | ¥4,900 | ¥17,640 |
| M7-9 | 5,000 | 300 | 6% | ¥14,700 | ¥61,740 |
| M10-12 | 8,000 | 600 | 7.5% | ¥29,400 | ¥150,000 |

**第一年总收入预期：¥15万**

### 9.3 成本结构

**开发期成本（6个月）：**
- 技术成本：¥6,000
  - AI API: ¥3,000
  - 云服务: ¥1,500
  - 开发者账号: ¥800
  - 其他工具: ¥700

**运营期成本（每月）：**
| 用户规模 | AI成本 | 云服务 | 其他 | 总计 |
|---------|--------|--------|------|------|
| <100用户 | ¥150 | ¥300 | ¥100 | ¥550 |
| 100-500 | ¥400 | ¥400 | ¥150 | ¥950 |
| 500-2000 | ¥1,200 | ¥600 | ¥200 | ¥2,000 |

**单用户成本：¥0.70-1.00/月**

### 9.4 盈亏平衡点

```
月度固定成本: ¥2,000
单用户ARPU: ¥15/月

盈亏平衡点 = 2000 / 15 = 134位付费用户

预计在第4-5个月达到盈亏平衡
```

---

## 十、风险与应对

### 10.1 技术风险

**风险1：OCR识别准确率不达标**
- **概率：中（20-30%）**
- **应对：**
  - 多引擎识别（本地+云端）
  - 用户手动校正选项
  - 客服远程协助
  - 持续训练模型

**风险2：AI成本超预算**
- **概率：中（30%）**
- **应对：**
  - Prompt Caching降低90%成本
  - 智能路由选择模型
  - 本地预处理降低云端调用
  - 批量处理

**风险3：政策更新不及时**
- **概率：高（各国政策经常变）**
- **应对：**
  - 每日自动爬取官方政策
  - 用户反馈机制
  - 法律免责声明
  - 人工审核关键更新

### 10.2 业务风险

**风险4：用户隐私泄露**
- **概率：极低（但后果严重）**
- **应对：**
  - 端到端加密
  - 定期安全审计
  - 购买网络安全保险
  - 应急响应预案

**风险5：竞品抄袭**
- **概率：高（成功后会被模仿）**
- **应对：**
  - 申请核心技术专利
  - 建立先发优势
  - 持续创新
  - 打造品牌信任

**风险6：海关不认可电子材料**
- **概率：低（5-10%）**
- **应对：**
  - 提供PDF打印选项
  - 机场打印服务合作
  - "保险服务"：拒入境退款+赔偿
  - 提前告知用户

### 10.3 法律合规

**合规要点：**
1. ✅ 数据保护法律
   - 中国《个人信息保护法》
   - GDPR（如服务欧洲用户）

2. ✅ 免责声明
   ```
   重要提示：
   - 本APP仅提供辅助信息，不保证入境成功
   - 最终入境决定权在各国海关
   - 请以官方政策为准
   - 我们不承担因政策变化导致的损失
   ```

3. ✅ 用户协议
   - 明确服务范围
   - 责任限制
   - 退款政策
   - 数据使用说明

---

## 十一、未来扩展（V2.0+）

### 11.1 功能扩展

**短期（6-12个月）：**
- [ ] 增加10个热门国家
  - 🇬🇧 英国
  - 🇦🇺 澳大利亚
  - 🇫🇷 法国
  - 🇩🇪 德国
  - 🇮🇹 意大利
  - 🇪🇸 西班牙
  - 🇦🇪 阿联酋
  - 🇳🇿 新西兰
  - 🇧🇷 巴西
  - 🇲🇽 墨西哥

- [ ] 语音功能（如果用户强烈需要）
  - 实时语音翻译
  - 发音指导
  - 语音对话模拟

- [ ] 行程管理
  - 机票/酒店预订整合
  - 行程自动同步
  - 提醒通知

**中期（12-24个月）：**
- [ ] 企业版
  - 团队管理
  - 差旅审批
  - 数据统计

- [ ] 社区功能
  - 用户攻略分享
  - 问题互助
  - 实时反馈

- [ ] AR功能
  - 实景翻译
  - 导航指引

**长期（24个月+）：**
- [ ] 全球覆盖100+国家
- [ ] AI旅行规划师
- [ ] 区块链证件存储
- [ ] 多设备同步

### 11.2 商业扩展

**B2B合作：**
- 旅行社白标解决方案
- 航空公司合作
- 酒店集团合作
- 保险公司合作

**增值服务：**
- 签证代办（抽佣20-30%）
- 机票预订（返佣3-5%）
- 酒店预订（返佣8-12%）
- 旅行保险（返佣10-15%）
- VIP机场服务

---

## 十二、成功指标

### 12.1 产品指标（6个月）

| 指标 | 目标 | 说明 |
|------|------|------|
| **通关成功率** | ≥95% | 使用APP的用户成功入境比例 |
| **OCR准确率** | ≥98% | 证件信息识别准确率 |
| **用户满意度** | ≥4.5/5 | App Store/Play Store评分 |
| **日活用户** | 500+ | 每日活跃用户数 |
| **付费转化率** | ≥6% | 免费转付费比例 |

### 12.2 业务指标（12个月）

| 指标 | 目标 | 说明 |
|------|------|------|
| **注册用户** | 10,000+ | 总注册用户数 |
| **付费用户** | 600+ | 总付费用户数 |
| **月活用户** | 2,000+ | 月活跃用户数 |
| **月收入** | ¥30,000+ | 月度营收 |
| **年收入** | ¥150,000+ | 年度营收 |
| **留存率（30天）** | ≥40% | 30天后仍使用的用户比例 |
| **NPS评分** | ≥50 | 净推荐值 |

### 12.3 运营指标

| 指标 | 目标 | 说明 |
|------|------|------|
| **响应时间** | <2s | API平均响应时间 |
| **错误率** | <1% | 系统错误率 |
| **客服响应** | <30min | 工作时间内客服响应时间 |
| **问题解决率** | ≥90% | 用户问题解决比例 |

---

## 十三、总结

### 13.1 核心价值

这个APP解决的核心问题：
1. ✅ **信息不对称** - AI帮助用户理解各国入境要求
2. ✅ **语言障碍** - 多语言自动生成和翻译
3. ✅ **重复填表** - 一次录入，永久使用
4. ✅ **材料准备** - 智能清单和验证
5. ✅ **应急备份** - 证件遗失时的救星

### 13.2 差异化优势

vs. 竞品：
- ❌ 翻译APP：不针对入境场景
- ❌ 签证服务：只管签证申请，不管入境
- ❌ 旅行管家：功能太多，不够专注
- ✅ **我们**：专注入境这一刻，做到极致

### 13.3 成功要素

1. **AI驱动** - Claude 4.5 Sonnet + GPT-5双引擎
2. **用户体验** - 大字体、简单操作、适合中老年
3. **核心创新** - 通关展示界面是杀手功能
4. **成本控制** - 智能路由降低70%成本
5. **持续迭代** - MVP验证后快速扩展

### 13.4 6个月里程碑

```
Month 1-2: 香港/台湾/泰国MVP
          ↓
Month 3:   美国/加拿大完整版
          ↓
Month 4:   测试优化
          ↓
Month 5-6: 上线推广
          ↓
目标: 1000用户, 300付费, ¥15,000/月收入
```

---

## 附录A: 快速开始检查清单

**开发前准备：**
- [ ] 申请阿里通义千问 API Key
- [ ] 申请百度文心一言 API Key
- [ ] 申请阿里云OCR API
- [ ] 创建Cloudflare账号 + Workers + D1数据库
- [ ] 申请百度翻译 API
- [ ] 申请微信开放平台 (¥300/年认证)
- [ ] 申请Apple Developer账号 ($99/年)
- [ ] 申请Google Play Developer账号 ($25一次性)

**第一周任务：**
- [ ] 创建React Native项目
- [ ] 配置开发环境
- [ ] 设计数据库schema
- [ ] 实现基础UI组件
- [ ] 集成相机功能

**第一个月目标：**
- [ ] 完成香港证件识别
- [ ] 生成第一个通关包
- [ ] 邀请10位用户测试

---

## 附录B: 关键代码示例

### 智能OCR路由
```javascript
// /lib/smartOCR.js
export async function smartOCR(imageBase64, docType) {
  // 1. 先用本地PaddleOCR（免费）
  try {
    const localResult = await paddleOCR.recognize(imageBase64);
    
    if (localResult.confidence > 0.95) {
      return {
        data: localResult.data,
        source: 'local',
        cost: 0
      };
    }
  } catch (error) {
    console.log('Local OCR failed, trying cloud...');
  }
  
  // 2. 本地失败，用GPT-4o（快速）
  try {
    const gptResult = await openai.vision({
      model: 'gpt-4o',
      image: imageBase64,
      prompt: `Extract all text from this ${docType}`
    });
    
    return {
      data: gptResult,
      source: 'gpt-4o',
      cost: 0.001
    };
  } catch (error) {
    console.log('GPT-4o failed, trying Google Vision...');
  }
  
  // 3. 最后用Google Vision（最准确）
  const googleResult = await googleVision.detect({
    image: imageBase64,
    features: ['DOCUMENT_TEXT_DETECTION']
  });
  
  return {
    data: googleResult,
    source: 'google-vision',
    cost: 0.0015
  };
}
```

### Claude Prompt Caching
```javascript
// /lib/claudeHelper.js
import Anthropic from '@anthropic-ai/sdk';

const anthropic = new Anthropic({
  apiKey: process.env.ANTHROPIC_API_KEY,
});

export async function analyzeWithCaching(userInfo, destination) {
  // 缓存各国入境规则（省90%成本）
  const cachedSystemPrompt = {
    type: "text",
    text: `你是出入境助手AI。以下是各国入境规则：
    
    香港入境规则：
    - 需要港澳通行证+有效签注
    - 无需填写入境卡
    - 通关时间5-15分钟
    ...
    
    台湾入境规则：
    - 需要大通证+入台证
    - 必须填写入境表
    - 繁体中文为主
    ...
    
    (更多规则...)
    `,
    cache_control: { type: "ephemeral" } // ⭐ 启用缓存
  };
  
  const response = await anthropic.messages.create({
    model: "claude-sonnet-4-5-20250929",
    max_tokens: 4096,
    system: [cachedSystemPrompt],
    messages: [
      {
        role: "user",
        content: `验证以下用户入境${destination}的材料：
        ${JSON.stringify(userInfo)}`
      }
    ]
  });
  
  // 首次调用: 缓存写入
  // 后续调用: 缓存读取（省90%）
  
  return JSON.parse(response.content[0].text);
}
```

---

**文档版本：** v1.0  
**最后更新：** 2025-06-01  
**作者：** 独立开发者  
**联系方式：** [待填写]

---

END OF DOCUMENT
