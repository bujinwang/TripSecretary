# å¾®ä¿¡æ”¯ä»˜é›†æˆæ–¹æ¡ˆ

> **æ ¸å¿ƒç›®æ ‡**: åœ¨React Native APPä¸­é›†æˆå¾®ä¿¡æ”¯ä»˜

---

## ä¸€ã€å¾®ä¿¡æ”¯ä»˜æ¦‚è¿°

### 1.1 å¾®ä¿¡æ”¯ä»˜ç±»å‹

```
å¾®ä¿¡æ”¯ä»˜æœ‰å¤šç§ç±»å‹:

1. APPæ”¯ä»˜ â­â­â­â­â­ï¼ˆæˆ‘ä»¬ç”¨è¿™ä¸ªï¼‰
   - åœ¨APPå†…è°ƒèµ·å¾®ä¿¡æ”¯ä»˜
   - é€‚åˆï¼šç§»åŠ¨åº”ç”¨
   - ç”¨æˆ·ä½“éªŒæœ€å¥½

2. H5æ”¯ä»˜ â­â­â­
   - åœ¨æ‰‹æœºæµè§ˆå™¨ä¸­æ”¯ä»˜
   - é€‚åˆï¼šç½‘é¡µ
   - ä½“éªŒç¨å·®

3. JSAPIæ”¯ä»˜ â­â­â­â­
   - åœ¨å¾®ä¿¡å†…æ‰“å¼€çš„ç½‘é¡µ
   - é€‚åˆï¼šå…¬ä¼—å·ã€å°ç¨‹åº
   - æˆ‘ä»¬ä¸éœ€è¦

4. Nativeæ”¯ä»˜ â­â­
   - æ‰«ç æ”¯ä»˜
   - é€‚åˆï¼šPCç½‘ç«™
   - æˆ‘ä»¬ä¸éœ€è¦
```

**æˆ‘ä»¬é€‰æ‹©ï¼šAPPæ”¯ä»˜**

---

## äºŒã€ç”³è¯·å¾®ä¿¡æ”¯ä»˜

### 2.1 å‰ç½®æ¡ä»¶

```
å¿…é¡»å…ˆæœ‰:
âœ… å¾®ä¿¡å¼€æ”¾å¹³å°è´¦å·ï¼ˆå·²ç”³è¯·ï¼Œç”¨äºå¾®ä¿¡ç™»å½•ï¼‰
âœ… ä¼ä¸šè®¤è¯ï¼ˆÂ¥300/å¹´ï¼‰

æ–°å¢éœ€è¦:
âœ… å¾®ä¿¡æ”¯ä»˜å•†æˆ·å·
âœ… å¯¹å…¬é“¶è¡Œè´¦æˆ·
âœ… è¥ä¸šæ‰§ç…§
```

### 2.2 ç”³è¯·æ­¥éª¤

**Step 1: ç”³è¯·å¾®ä¿¡æ”¯ä»˜å•†æˆ·å·**

```
1. ç™»å½•å¾®ä¿¡æ”¯ä»˜å•†æˆ·å¹³å°
   https://pay.weixin.qq.com

2. æäº¤èµ„æ–™
   - è¥ä¸šæ‰§ç…§
   - æ³•äººèº«ä»½è¯
   - å¯¹å…¬é“¶è¡Œè´¦æˆ·
   - ç»è¥åœºæ™¯è¯´æ˜

3. å®¡æ ¸æ—¶é—´
   - 1-5ä¸ªå·¥ä½œæ—¥

4. å®¡æ ¸é€šè¿‡åè·å¾—
   - å•†æˆ·å·ï¼ˆMCHIDï¼‰
   - APIå¯†é’¥ï¼ˆAPI Keyï¼‰
   - å•†æˆ·è¯ä¹¦
```

**Step 2: åœ¨å¾®ä¿¡å¼€æ”¾å¹³å°å…³è”å•†æˆ·å·**

```
1. ç™»å½•å¾®ä¿¡å¼€æ”¾å¹³å°
   https://open.weixin.qq.com

2. è¿›å…¥ä½ çš„APP
   "ç®¡ç†ä¸­å¿ƒ" â†’ "ç§»åŠ¨åº”ç”¨" â†’ "ä½ çš„APP"

3. å…³è”å•†æˆ·å·
   "æ”¯ä»˜åŠŸèƒ½" â†’ "ç”³è¯·å¼€é€š" â†’ è¾“å…¥å•†æˆ·å·

4. ç­‰å¾…å®¡æ ¸ï¼ˆ1-3å¤©ï¼‰
```

### 2.3 è´¹ç‡

```
å¾®ä¿¡æ”¯ä»˜è´¹ç‡:

æ ‡å‡†è´¹ç‡:
- 0.6% per transaction
- æœ€ä½: Â¥0.01
- æ— å°é¡¶

ç¤ºä¾‹:
- ç”¨æˆ·æ”¯ä»˜ Â¥10 â†’ å•†å®¶æ”¶åˆ° Â¥9.94ï¼ˆæ‰£é™¤Â¥0.06ï¼‰
- ç”¨æˆ·æ”¯ä»˜ Â¥100 â†’ å•†å®¶æ”¶åˆ° Â¥99.40ï¼ˆæ‰£é™¤Â¥0.60ï¼‰

ç»“ç®—å‘¨æœŸ:
- T+1ï¼ˆæ¬¡æ—¥åˆ°è´¦ï¼‰
- è‡ªåŠ¨ç»“ç®—åˆ°å¯¹å…¬è´¦æˆ·
```

---

## ä¸‰ã€æŠ€æœ¯å®ç°

### 3.1 æ•´ä½“æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·åœ¨APPé€‰æ‹©ä»˜è´¹åŠŸèƒ½                 â”‚
â”‚   ä¾‹å¦‚ï¼šè´­ä¹°é«˜çº§ä¼šå‘˜ Â¥99/å¹´            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   APPå‘é€è¯·æ±‚åˆ°åç«¯                     â”‚
â”‚   POST /api/pay/create                  â”‚
â”‚   { amount: 99, product: 'vip' }        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Cloudflare Workerè°ƒç”¨å¾®ä¿¡API          â”‚
â”‚   åˆ›å»ºé¢„æ”¯ä»˜è®¢å•                        â”‚
â”‚   è·å–: prepay_id                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è¿”å›æ”¯ä»˜å‚æ•°ç»™APP                     â”‚
â”‚   { prepay_id, sign, timestamp... }     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   APPè°ƒèµ·å¾®ä¿¡æ”¯ä»˜                       â”‚
â”‚   è·³è½¬åˆ°å¾®ä¿¡APP                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·åœ¨å¾®ä¿¡APPä¸­å®Œæˆæ”¯ä»˜               â”‚
â”‚   è¾“å…¥å¯†ç /æŒ‡çº¹/äººè„¸                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¾®ä¿¡å›è°ƒé€šçŸ¥åç«¯                      â”‚
â”‚   POST /api/pay/notify                  â”‚
â”‚   { transaction_id, status... }         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åç«¯éªŒè¯ç­¾å                          â”‚
â”‚   æ›´æ–°è®¢å•çŠ¶æ€                          â”‚
â”‚   å¼€é€šä¼šå‘˜æƒé™                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è¿”å›APPï¼Œæ˜¾ç¤ºæ”¯ä»˜æˆåŠŸ                 â”‚
â”‚   ç”¨æˆ·å¯ä»¥ä½¿ç”¨é«˜çº§åŠŸèƒ½                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 å‰ç«¯å®ç°ï¼ˆReact Nativeï¼‰

**å®‰è£…ä¾èµ–ï¼š**

```bash
npm install react-native-wechat-lib
```

**é…ç½®å’Œä»£ç ï¼š**

```javascript
// /services/wechatPay.js
import * as WeChat from 'react-native-wechat-lib';

class WechatPayService {
  constructor() {
    // åˆå§‹åŒ–å¾®ä¿¡SDKï¼ˆç™»å½•æ—¶å·²ç»åˆå§‹åŒ–ï¼‰
  }

  // å‘èµ·æ”¯ä»˜
  async pay(productId, amount) {
    try {
      // 1. åˆ›å»ºè®¢å•ï¼ˆè°ƒç”¨åç«¯ï¼‰
      const orderResponse = await fetch('https://your-worker.workers.dev/api/pay/create', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${userToken}`
        },
        body: JSON.stringify({
          product_id: productId,
          amount: amount,
          user_id: userId
        })
      });

      const orderData = await orderResponse.json();

      if (!orderData.success) {
        throw new Error(orderData.message);
      }

      // 2. è°ƒèµ·å¾®ä¿¡æ”¯ä»˜
      const payResult = await WeChat.pay({
        partnerId: orderData.partnerId,     // å•†æˆ·å·
        prepayId: orderData.prepayId,       // é¢„æ”¯ä»˜ID
        nonceStr: orderData.nonceStr,       // éšæœºå­—ç¬¦ä¸²
        timeStamp: orderData.timeStamp,     // æ—¶é—´æˆ³
        package: orderData.package,         // æ‰©å±•å­—æ®µ
        sign: orderData.sign                // ç­¾å
      });

      console.log('âœ… æ”¯ä»˜æˆåŠŸ', payResult);

      // 3. æ”¯ä»˜æˆåŠŸåçš„å¤„ç†
      return {
        success: true,
        message: 'æ”¯ä»˜æˆåŠŸ',
        orderId: orderData.orderId
      };

    } catch (error) {
      console.error('âŒ æ”¯ä»˜å¤±è´¥', error);

      // å¤„ç†ä¸åŒçš„é”™è¯¯
      if (error.code === '-2') {
        // ç”¨æˆ·å–æ¶ˆ
        return {
          success: false,
          message: 'æ”¯ä»˜å·²å–æ¶ˆ',
          code: 'USER_CANCEL'
        };
      } else if (error.code === '-1') {
        // æ”¯ä»˜å¤±è´¥
        return {
          success: false,
          message: 'æ”¯ä»˜å¤±è´¥ï¼Œè¯·é‡è¯•',
          code: 'PAY_FAILED'
        };
      } else {
        // å…¶ä»–é”™è¯¯
        return {
          success: false,
          message: error.message || 'æ”¯ä»˜å‡ºé”™',
          code: 'UNKNOWN_ERROR'
        };
      }
    }
  }

  // æŸ¥è¯¢è®¢å•çŠ¶æ€
  async queryOrder(orderId) {
    const response = await fetch(
      `https://your-worker.workers.dev/api/pay/query/${orderId}`,
      {
        headers: {
          'Authorization': `Bearer ${userToken}`
        }
      }
    );

    return await response.json();
  }
}

export default new WechatPayService();
```

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ”¯ä»˜é¡µé¢ï¼‰ï¼š**

```javascript
// /screens/VIPUpgradeScreen.jsx
import React, { useState } from 'react';
import { View, Text, Button, Alert, ActivityIndicator } from 'react-native';
import WechatPayService from '@/services/wechatPay';

export default function VIPUpgradeScreen() {
  const [loading, setLoading] = useState(false);

  const handlePurchase = async () => {
    setLoading(true);

    try {
      const result = await WechatPayService.pay('vip_yearly', 99);

      if (result.success) {
        Alert.alert(
          'æ”¯ä»˜æˆåŠŸ',
          'æ‚¨å·²æˆä¸ºé«˜çº§ä¼šå‘˜ï¼',
          [
            {
              text: 'ç¡®å®š',
              onPress: () => {
                // åˆ·æ–°ç”¨æˆ·çŠ¶æ€
                refreshUserStatus();
                // è·³è½¬åˆ°ä¼šå‘˜é¡µ
                navigation.navigate('VIPBenefits');
              }
            }
          ]
        );
      } else if (result.code === 'USER_CANCEL') {
        // ç”¨æˆ·å–æ¶ˆï¼Œä¸æç¤ºé”™è¯¯
        console.log('ç”¨æˆ·å–æ¶ˆæ”¯ä»˜');
      } else {
        Alert.alert('æ”¯ä»˜å¤±è´¥', result.message);
      }
    } catch (error) {
      Alert.alert('é”™è¯¯', 'æ”¯ä»˜å‡ºé”™ï¼Œè¯·é‡è¯•');
    } finally {
      setLoading(false);
    }
  };

  return (
    <View style={styles.container}>
      <Text style={styles.title}>å‡çº§é«˜çº§ä¼šå‘˜</Text>

      <View style={styles.priceCard}>
        <Text style={styles.price}>Â¥99</Text>
        <Text style={styles.period}>/ å¹´</Text>
      </View>

      <View style={styles.benefits}>
        <Text style={styles.benefitItem}>âœ… æ— é™æ¬¡æ•°ç”Ÿæˆé€šå…³åŒ…</Text>
        <Text style={styles.benefitItem}>âœ… ä¼˜å…ˆAIå¤„ç†</Text>
        <Text style={styles.benefitItem}>âœ… é«˜çº§é—®ç­”æ¨¡æ¿</Text>
        <Text style={styles.benefitItem}>âœ… äº‘ç«¯å¤‡ä»½</Text>
        <Text style={styles.benefitItem}>âœ… å¤šè®¾å¤‡åŒæ­¥</Text>
      </View>

      <Button
        title={loading ? 'å¤„ç†ä¸­...' : 'å¾®ä¿¡æ”¯ä»˜'}
        onPress={handlePurchase}
        disabled={loading}
        color="#07C160" // å¾®ä¿¡ç»¿
      />

      {loading && (
        <ActivityIndicator size="large" color="#07C160" style={styles.loader} />
      )}

      <Text style={styles.hint}>
        ç‚¹å‡»æ”¯ä»˜å³è¡¨ç¤ºåŒæ„ã€Šä¼šå‘˜æœåŠ¡åè®®ã€‹
      </Text>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    padding: 20,
    backgroundColor: '#fff',
  },
  title: {
    fontSize: 28,
    fontWeight: 'bold',
    textAlign: 'center',
    marginBottom: 30,
  },
  priceCard: {
    flexDirection: 'row',
    justifyContent: 'center',
    alignItems: 'baseline',
    backgroundColor: '#f5f5f5',
    padding: 30,
    borderRadius: 10,
    marginBottom: 30,
  },
  price: {
    fontSize: 48,
    fontWeight: 'bold',
    color: '#07C160',
  },
  period: {
    fontSize: 20,
    color: '#666',
    marginLeft: 5,
  },
  benefits: {
    marginBottom: 30,
  },
  benefitItem: {
    fontSize: 16,
    marginBottom: 10,
    paddingLeft: 10,
  },
  hint: {
    marginTop: 20,
    fontSize: 12,
    color: '#999',
    textAlign: 'center',
  },
  loader: {
    marginTop: 20,
  }
});
```

---

### 3.3 åç«¯å®ç°ï¼ˆCloudflare Workerï¼‰

**å®‰è£…ä¾èµ–ï¼š**

```bash
npm install crypto-js
```

**åˆ›å»ºæ”¯ä»˜è®¢å•ï¼š**

```javascript
// workers/api/pay/create.js
import crypto from 'crypto';

export default {
  async fetch(request, env) {
    try {
      // 1. è·å–è¯·æ±‚å‚æ•°
      const { product_id, amount, user_id } = await request.json();

      // 2. éªŒè¯ç”¨æˆ·token
      const userId = verifyToken(request.headers.get('Authorization'));
      if (!userId) {
        return new Response(JSON.stringify({ error: 'Unauthorized' }), {
          status: 401
        });
      }

      // 3. åˆ›å»ºè®¢å•å·
      const orderId = generateOrderId(); // å¦‚: 'TS20250601123456789'

      // 4. ä¿å­˜è®¢å•åˆ°æ•°æ®åº“
      await env.DB.prepare(`
        INSERT INTO orders (
          order_id,
          user_id,
          product_id,
          amount,
          status,
          created_at
        ) VALUES (?, ?, ?, ?, 'PENDING', datetime('now'))
      `).bind(orderId, userId, product_id, amount).run();

      // 5. è°ƒç”¨å¾®ä¿¡ç»Ÿä¸€ä¸‹å•API
      const prepayData = await createWechatOrder({
        orderId: orderId,
        amount: amount,
        userId: userId,
        productName: getProductName(product_id),
        env: env
      });

      // 6. è¿”å›æ”¯ä»˜å‚æ•°ç»™APP
      return new Response(JSON.stringify({
        success: true,
        orderId: orderId,
        ...prepayData
      }), {
        headers: { 'Content-Type': 'application/json' }
      });

    } catch (error) {
      console.error('åˆ›å»ºè®¢å•å¤±è´¥:', error);
      return new Response(JSON.stringify({
        success: false,
        message: error.message
      }), {
        status: 500
      });
    }
  }
};

// è°ƒç”¨å¾®ä¿¡ç»Ÿä¸€ä¸‹å•API
async function createWechatOrder({ orderId, amount, userId, productName, env }) {
  const appid = env.WECHAT_APP_ID;
  const mchid = env.WECHAT_MCHID; // å•†æˆ·å·
  const apiKey = env.WECHAT_API_KEY; // APIå¯†é’¥

  // å‡†å¤‡å‚æ•°
  const nonceStr = generateNonceStr();
  const timestamp = Math.floor(Date.now() / 1000).toString();

  const params = {
    appid: appid,
    mch_id: mchid,
    nonce_str: nonceStr,
    body: productName, // å•†å“æè¿°
    out_trade_no: orderId, // å•†æˆ·è®¢å•å·
    total_fee: amount * 100, // é‡‘é¢ï¼ˆåˆ†ï¼‰
    spbill_create_ip: '127.0.0.1',
    notify_url: 'https://your-worker.workers.dev/api/pay/notify',
    trade_type: 'APP'
  };

  // ç”Ÿæˆç­¾å
  const sign = generateSign(params, apiKey);
  params.sign = sign;

  // è½¬æ¢ä¸ºXML
  const xmlData = objectToXml(params);

  // è°ƒç”¨å¾®ä¿¡API
  const response = await fetch('https://api.mch.weixin.qq.com/pay/unifiedorder', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/xml'
    },
    body: xmlData
  });

  const xmlResponse = await response.text();
  const result = xmlToObject(xmlResponse);

  if (result.return_code !== 'SUCCESS' || result.result_code !== 'SUCCESS') {
    throw new Error(result.err_code_des || 'å¾®ä¿¡ä¸‹å•å¤±è´¥');
  }

  // è·å–prepay_id
  const prepayId = result.prepay_id;

  // ç”ŸæˆAPPè°ƒèµ·æ”¯ä»˜çš„å‚æ•°
  const payParams = {
    appid: appid,
    partnerid: mchid,
    prepayid: prepayId,
    package: 'Sign=WXPay',
    noncestr: generateNonceStr(),
    timestamp: timestamp
  };

  // ç”Ÿæˆç­¾å
  payParams.sign = generateSign(payParams, apiKey);

  return {
    partnerId: mchid,
    prepayId: prepayId,
    nonceStr: payParams.noncestr,
    timeStamp: timestamp,
    package: payParams.package,
    sign: payParams.sign
  };
}

// ç”Ÿæˆç­¾å
function generateSign(params, apiKey) {
  // 1. å‚æ•°åASCIIç ä»å°åˆ°å¤§æ’åº
  const keys = Object.keys(params).sort();
  
  // 2. æ‹¼æ¥å­—ç¬¦ä¸²
  const stringA = keys
    .filter(key => params[key] !== '' && key !== 'sign')
    .map(key => `${key}=${params[key]}`)
    .join('&');
  
  // 3. æ‹¼æ¥APIå¯†é’¥
  const stringSignTemp = `${stringA}&key=${apiKey}`;
  
  // 4. MD5åŠ å¯†å¹¶è½¬å¤§å†™
  return crypto
    .createHash('md5')
    .update(stringSignTemp, 'utf8')
    .digest('hex')
    .toUpperCase();
}

// ç”Ÿæˆéšæœºå­—ç¬¦ä¸²
function generateNonceStr() {
  return crypto.randomBytes(16).toString('hex');
}

// ç”Ÿæˆè®¢å•å·
function generateOrderId() {
  const date = new Date();
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  const hours = String(date.getHours()).padStart(2, '0');
  const minutes = String(date.getMinutes()).padStart(2, '0');
  const seconds = String(date.getSeconds()).padStart(2, '0');
  const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
  
  return `TS${year}${month}${day}${hours}${minutes}${seconds}${random}`;
}

// å¯¹è±¡è½¬XML
function objectToXml(obj) {
  let xml = '<xml>';
  for (const key in obj) {
    xml += `<${key}><![CDATA[${obj[key]}]]></${key}>`;
  }
  xml += '</xml>';
  return xml;
}

// XMLè½¬å¯¹è±¡
function xmlToObject(xml) {
  const obj = {};
  const regex = /<(\w+)><!\[CDATA\[(.*?)\]\]><\/\1>/g;
  let match;
  
  while ((match = regex.exec(xml)) !== null) {
    obj[match[1]] = match[2];
  }
  
  return obj;
}

function getProductName(productId) {
  const products = {
    'vip_yearly': 'é«˜çº§ä¼šå‘˜-å¹´è´¹',
    'vip_monthly': 'é«˜çº§ä¼šå‘˜-æœˆè´¹',
    'credits_10': '10æ¬¡ç”Ÿæˆé¢åº¦',
    'credits_50': '50æ¬¡ç”Ÿæˆé¢åº¦'
  };
  return products[productId] || 'é€šå…³åŠ©æ‰‹æœåŠ¡';
}
```

**æ”¯ä»˜å›è°ƒå¤„ç†ï¼š**

```javascript
// workers/api/pay/notify.js
export default {
  async fetch(request, env) {
    try {
      // 1. æ¥æ”¶å¾®ä¿¡å›è°ƒæ•°æ®ï¼ˆXMLæ ¼å¼ï¼‰
      const xmlData = await request.text();
      console.log('æ”¶åˆ°å¾®ä¿¡å›è°ƒ:', xmlData);

      // 2. è§£æXML
      const data = xmlToObject(xmlData);

      // 3. éªŒè¯ç­¾å
      const apiKey = env.WECHAT_API_KEY;
      const sign = data.sign;
      delete data.sign;
      
      const calculatedSign = generateSign(data, apiKey);
      
      if (sign !== calculatedSign) {
        console.error('âŒ ç­¾åéªŒè¯å¤±è´¥');
        return new Response(failXml('ç­¾åéªŒè¯å¤±è´¥'));
      }

      // 4. æ£€æŸ¥æ”¯ä»˜ç»“æœ
      if (data.return_code !== 'SUCCESS' || data.result_code !== 'SUCCESS') {
        console.error('âŒ æ”¯ä»˜å¤±è´¥:', data);
        return new Response(failXml('æ”¯ä»˜å¤±è´¥'));
      }

      // 5. è·å–è®¢å•ä¿¡æ¯
      const orderId = data.out_trade_no;
      const transactionId = data.transaction_id;
      const totalFee = parseInt(data.total_fee) / 100; // è½¬ä¸ºå…ƒ

      // 6. æŸ¥è¯¢è®¢å•
      const order = await env.DB.prepare(
        'SELECT * FROM orders WHERE order_id = ?'
      ).bind(orderId).first();

      if (!order) {
        console.error('âŒ è®¢å•ä¸å­˜åœ¨:', orderId);
        return new Response(failXml('è®¢å•ä¸å­˜åœ¨'));
      }

      if (order.status === 'PAID') {
        console.log('âš ï¸ è®¢å•å·²æ”¯ä»˜ï¼Œè·³è¿‡');
        return new Response(successXml());
      }

      // 7. æ›´æ–°è®¢å•çŠ¶æ€
      await env.DB.prepare(`
        UPDATE orders 
        SET 
          status = 'PAID',
          transaction_id = ?,
          paid_at = datetime('now')
        WHERE order_id = ?
      `).bind(transactionId, orderId).run();

      // 8. å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼ˆå¼€é€šä¼šå‘˜ç­‰ï¼‰
      await handlePaymentSuccess(order, env);

      console.log('âœ… æ”¯ä»˜æˆåŠŸå¤„ç†å®Œæˆ:', orderId);

      // 9. è¿”å›æˆåŠŸç»™å¾®ä¿¡
      return new Response(successXml(), {
        headers: { 'Content-Type': 'application/xml' }
      });

    } catch (error) {
      console.error('å¤„ç†å›è°ƒå¤±è´¥:', error);
      return new Response(failXml('å¤„ç†å¤±è´¥'), {
        headers: { 'Content-Type': 'application/xml' }
      });
    }
  }
};

// å¤„ç†æ”¯ä»˜æˆåŠŸåçš„ä¸šåŠ¡é€»è¾‘
async function handlePaymentSuccess(order, env) {
  const userId = order.user_id;
  const productId = order.product_id;

  if (productId === 'vip_yearly') {
    // å¼€é€šå¹´åº¦ä¼šå‘˜
    const expiryDate = new Date();
    expiryDate.setFullYear(expiryDate.getFullYear() + 1);

    await env.DB.prepare(`
      UPDATE users 
      SET 
        is_vip = 1,
        vip_expiry = ?
      WHERE id = ?
    `).bind(expiryDate.toISOString(), userId).run();

  } else if (productId === 'vip_monthly') {
    // å¼€é€šæœˆåº¦ä¼šå‘˜
    const expiryDate = new Date();
    expiryDate.setMonth(expiryDate.getMonth() + 1);

    await env.DB.prepare(`
      UPDATE users 
      SET 
        is_vip = 1,
        vip_expiry = ?
      WHERE id = ?
    `).bind(expiryDate.toISOString(), userId).run();

  } else if (productId.startsWith('credits_')) {
    // å¢åŠ ç”Ÿæˆé¢åº¦
    const credits = parseInt(productId.split('_')[1]);

    await env.DB.prepare(`
      UPDATE users 
      SET credits = credits + ?
      WHERE id = ?
    `).bind(credits, userId).run();
  }
}

// æˆåŠŸè¿”å›ç»™å¾®ä¿¡
function successXml() {
  return `
    <xml>
      <return_code><![CDATA[SUCCESS]]></return_code>
      <return_msg><![CDATA[OK]]></return_msg>
    </xml>
  `;
}

// å¤±è´¥è¿”å›ç»™å¾®ä¿¡
function failXml(message) {
  return `
    <xml>
      <return_code><![CDATA[FAIL]]></return_code>
      <return_msg><![CDATA[${message}]]></return_msg>
    </xml>
  `;
}
```

---

## å››ã€æ•°æ®åº“è®¾è®¡

### 4.1 è®¢å•è¡¨

```sql
-- åˆ›å»ºè®¢å•è¡¨
CREATE TABLE orders (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  order_id TEXT UNIQUE NOT NULL,       -- è®¢å•å·
  user_id INTEGER NOT NULL,            -- ç”¨æˆ·ID
  product_id TEXT NOT NULL,            -- å•†å“ID
  amount REAL NOT NULL,                -- é‡‘é¢ï¼ˆå…ƒï¼‰
  status TEXT DEFAULT 'PENDING',       -- çŠ¶æ€ï¼šPENDING, PAID, FAILED, REFUNDED
  transaction_id TEXT,                 -- å¾®ä¿¡äº¤æ˜“å·
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  paid_at DATETIME,                    -- æ”¯ä»˜æ—¶é—´
  
  FOREIGN KEY (user_id) REFERENCES users(id)
);

CREATE INDEX idx_orders_user ON orders(user_id);
CREATE INDEX idx_orders_status ON orders(status);

-- å•†å“è¡¨
CREATE TABLE products (
  id TEXT PRIMARY KEY,                 -- å•†å“ID
  name TEXT NOT NULL,                  -- å•†å“åç§°
  description TEXT,                    -- æè¿°
  price REAL NOT NULL,                 -- ä»·æ ¼ï¼ˆå…ƒï¼‰
  type TEXT NOT NULL,                  -- ç±»å‹ï¼šVIP, CREDITS
  duration INTEGER,                    -- æ—¶é•¿ï¼ˆå¤©ï¼‰ï¼ŒVIPç”¨
  credits INTEGER,                     -- é¢åº¦ï¼ŒCREDITSç”¨
  active INTEGER DEFAULT 1             -- æ˜¯å¦å¯ç”¨
);

-- æ’å…¥å•†å“
INSERT INTO products VALUES
  ('vip_yearly', 'é«˜çº§ä¼šå‘˜-å¹´è´¹', 'æ— é™æ¬¡ç”Ÿæˆï¼Œä¼˜å…ˆå¤„ç†', 99, 'VIP', 365, NULL, 1),
  ('vip_monthly', 'é«˜çº§ä¼šå‘˜-æœˆè´¹', 'æ— é™æ¬¡ç”Ÿæˆï¼Œä¼˜å…ˆå¤„ç†', 12, 'VIP', 30, NULL, 1),
  ('credits_10', '10æ¬¡ç”Ÿæˆé¢åº¦', '10æ¬¡AIç”Ÿæˆé¢åº¦', 9.9, 'CREDITS', NULL, 10, 1),
  ('credits_50', '50æ¬¡ç”Ÿæˆé¢åº¦', '50æ¬¡AIç”Ÿæˆé¢åº¦', 39.9, 'CREDITS', NULL, 50, 1);

-- ç”¨æˆ·è¡¨å¢åŠ VIPå­—æ®µ
ALTER TABLE users ADD COLUMN is_vip INTEGER DEFAULT 0;
ALTER TABLE users ADD COLUMN vip_expiry DATETIME;
ALTER TABLE users ADD COLUMN credits INTEGER DEFAULT 3; -- å…è´¹ç”¨æˆ·3æ¬¡
```

---

## äº”ã€æ”¶è´¹æ¨¡å¼å»ºè®®

### 5.1 æ¨èçš„å®šä»·ç­–ç•¥

```
å…è´¹ç‰ˆï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰:
âœ… æ¯æœˆ3æ¬¡ç”Ÿæˆé¢åº¦
âœ… åŸºç¡€æ¨¡æ¿
âœ… æœ¬åœ°å­˜å‚¨
âœ… æ ‡å‡†å¤„ç†é€Ÿåº¦

é«˜çº§ä¼šå‘˜ï¼ˆÂ¥99/å¹´ æˆ– Â¥12/æœˆï¼‰:
âœ… æ— é™æ¬¡ç”Ÿæˆ
âœ… æ‰€æœ‰æ¨¡æ¿
âœ… äº‘ç«¯åŒæ­¥
âœ… ä¼˜å…ˆAIå¤„ç†ï¼ˆæ›´å¿«ï¼‰
âœ… å†å²è®°å½•æ°¸ä¹…ä¿å­˜
âœ… å¤šè®¾å¤‡åŒæ­¥

å•æ¬¡è´­ä¹°ï¼ˆæŒ‰éœ€ï¼‰:
âœ… 10æ¬¡é¢åº¦ - Â¥9.9
âœ… 50æ¬¡é¢åº¦ - Â¥39.9
```

### 5.2 å®šä»·å¿ƒç†å­¦

```
ä¸ºä»€ä¹ˆ Â¥99/å¹´ å¥½äº Â¥9/æœˆï¼Ÿ

Â¥9/æœˆ:
- ç”¨æˆ·æ„Ÿè§‰: æ¯æœˆä»˜è´¹ï¼Œæœ‰å‹åŠ›
- å¹´æ€»ä»·: Â¥108
- ç»­è´¹ç‡: è¾ƒä½ï¼ˆ60-70%ï¼‰

Â¥99/å¹´:
- ç”¨æˆ·æ„Ÿè§‰: ä¸€æ¬¡æ€§ï¼Œåˆ’ç®—
- å¹´æ€»ä»·: Â¥99ï¼ˆä¾¿å®œÂ¥9ï¼‰
- ç»­è´¹ç‡: è¾ƒé«˜ï¼ˆ75-85%ï¼‰
- æå‰é”å®šç”¨æˆ·ä¸€å¹´

æ¨èç­–ç•¥:
ä¸»æ¨å¹´è´¹ Â¥99
å¤‡é€‰æœˆè´¹ Â¥12ï¼ˆæ¯”Â¥9è´µï¼Œå¼•å¯¼ç”¨æˆ·ä¹°å¹´è´¹ï¼‰
```

### 5.3 è½¬åŒ–ç‡ä¼˜åŒ–

```javascript
// åœ¨APPä¸­å±•ç¤ºä»·æ ¼å¯¹æ¯”
function PricingComparison() {
  return (
    <View>
      <View style={styles.planCard}>
        <Text style={styles.badge}>ğŸ’° æœ€åˆ’ç®—</Text>
        <Text style={styles.planName}>å¹´åº¦ä¼šå‘˜</Text>
        <Text style={styles.price}>Â¥99</Text>
        <Text style={styles.perMonth}>ä»… Â¥8.25/æœˆ</Text>
        <Text style={styles.savings}>æ¯”æœˆä»˜çœ Â¥45</Text>
        <Button title="ç«‹å³è´­ä¹°" />
      </View>

      <View style={styles.planCard}>
        <Text style={styles.planName}>æœˆåº¦ä¼šå‘˜</Text>
        <Text style={styles.price}>Â¥12</Text>
        <Text style={styles.perMonth}>Â¥12/æœˆ</Text>
        <Button title="è´­ä¹°" variant="secondary" />
      </View>
    </View>
  );
}
```

---

## å…­ã€æµ‹è¯•

### 6.1 å¾®ä¿¡æ”¯ä»˜æ²™ç®±ç¯å¢ƒ

```
å¾®ä¿¡æä¾›æ²™ç®±ç¯å¢ƒæµ‹è¯•:

1. ç”³è¯·æ²™ç®±å¯†é’¥
   https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=23_1

2. ä½¿ç”¨æ²™ç®±è´¦å·æµ‹è¯•
   - ä¸ä¼šçœŸçš„æ‰£æ¬¾
   - å¯ä»¥æ¨¡æ‹Ÿå„ç§æ”¯ä»˜åœºæ™¯

3. æµ‹è¯•ç”¨ä¾‹
   âœ… æ”¯ä»˜æˆåŠŸ
   âœ… æ”¯ä»˜å¤±è´¥
   âœ… ç”¨æˆ·å–æ¶ˆ
   âœ… ç½‘ç»œè¶…æ—¶
   âœ… é‡å¤æ”¯ä»˜
   âœ… é€€æ¬¾
```

### 6.2 æµ‹è¯•æ¸…å•

```
â–¡ æ­£å¸¸æ”¯ä»˜æµç¨‹
â–¡ ç”¨æˆ·å–æ¶ˆæ”¯ä»˜
â–¡ æ”¯ä»˜è¶…æ—¶
â–¡ ç½‘ç»œé”™è¯¯
â–¡ è®¢å•é‡å¤æäº¤
â–¡ å›è°ƒç­¾åéªŒè¯
â–¡ è®¢å•çŠ¶æ€æ›´æ–°
â–¡ ä¼šå‘˜æƒé™å¼€é€š
â–¡ é¢åº¦å¢åŠ 
â–¡ APPæ”¯ä»˜å‚æ•°æ­£ç¡®æ€§
```

---

## ä¸ƒã€å®‰å…¨æ³¨æ„äº‹é¡¹

### 7.1 å…³é”®å®‰å…¨ç‚¹

```
âœ… APIå¯†é’¥ä¿æŠ¤
   - å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡
   - ä¸è¦ç¡¬ç¼–ç 
   - å®šæœŸæ›´æ¢

âœ… ç­¾åéªŒè¯
   - æ‰€æœ‰è¯·æ±‚éªŒè¯ç­¾å
   - é˜²æ­¢ç¯¡æ”¹

âœ… å›è°ƒéªŒè¯
   - éªŒè¯å¾®ä¿¡IPç™½åå•
   - éªŒè¯ç­¾å
   - é˜²æ­¢é‡æ”¾æ”»å‡»

âœ… è®¢å•çŠ¶æ€
   - é˜²æ­¢é‡å¤å¤„ç†
   - å¹‚ç­‰æ€§è®¾è®¡

âœ… é‡‘é¢éªŒè¯
   - å‰åç«¯éƒ½éªŒè¯
   - é˜²æ­¢ç¯¡æ”¹é‡‘é¢
```

### 7.2 å®‰å…¨ä»£ç ç¤ºä¾‹

```javascript
// éªŒè¯å›è°ƒIPï¼ˆå¯é€‰ï¼‰
function verifyWechatIP(request) {
  const clientIP = request.headers.get('CF-Connecting-IP');
  const wechatIPs = [
    '101.226.103.*',
    '101.226.62.*',
    // ... å¾®ä¿¡æœåŠ¡å™¨IPæ®µ
  ];
  
  return wechatIPs.some(ip => {
    const pattern = ip.replace('*', '\\d+');
    return new RegExp(pattern).test(clientIP);
  });
}

// é˜²æ­¢é‡å¤å›è°ƒ
async function checkDuplicateCallback(orderId, env) {
  const lock = await env.MY_KV.get(`payment_lock:${orderId}`);
  
  if (lock) {
    throw new Error('è®¢å•æ­£åœ¨å¤„ç†ä¸­');
  }
  
  // è®¾ç½®é”ï¼Œ5åˆ†é’Ÿè¿‡æœŸ
  await env.MY_KV.put(
    `payment_lock:${orderId}`, 
    '1', 
    { expirationTtl: 300 }
  );
}
```

---

## å…«ã€é€€æ¬¾å¤„ç†

### 8.1 é€€æ¬¾API

```javascript
// workers/api/pay/refund.js
export default {
  async fetch(request, env) {
    const { order_id, reason } = await request.json();

    // 1. æŸ¥è¯¢è®¢å•
    const order = await env.DB.prepare(
      'SELECT * FROM orders WHERE order_id = ? AND status = "PAID"'
    ).bind(order_id).first();

    if (!order) {
      return new Response(JSON.stringify({
        success: false,
        message: 'è®¢å•ä¸å­˜åœ¨æˆ–æœªæ”¯ä»˜'
      }), { status: 404 });
    }

    // 2. è°ƒç”¨å¾®ä¿¡é€€æ¬¾API
    const refundResult = await callWechatRefund({
      transactionId: order.transaction_id,
      totalFee: order.amount * 100,
      refundFee: order.amount * 100,
      orderId: order_id,
      reason: reason,
      env: env
    });

    if (refundResult.return_code !== 'SUCCESS') {
      throw new Error('é€€æ¬¾å¤±è´¥');
    }

    // 3. æ›´æ–°è®¢å•çŠ¶æ€
    await env.DB.prepare(`
      UPDATE orders 
      SET status = 'REFUNDED', refund_at = datetime('now')
      WHERE order_id = ?
    `).bind(order_id).run();

    // 4. æ’¤é”€ä¼šå‘˜æƒé™
    await revokeVIPAccess(order.user_id, env);

    return new Response(JSON.stringify({
      success: true,
      message: 'é€€æ¬¾æˆåŠŸ'
    }));
  }
};
```

---

## ä¹ã€å¸¸è§é—®é¢˜

### Q1: å¾®ä¿¡æ”¯ä»˜è´¹ç‡å¯ä»¥åå•†å—ï¼Ÿ

**ç­”ï¼šå¯ä»¥ï¼Œä½†éœ€è¦æ»¡è¶³æ¡ä»¶**
```
æ ‡å‡†è´¹ç‡: 0.6%

å¯åå•†çš„æƒ…å†µ:
- äº¤æ˜“é‡å¤§ï¼ˆæœˆæµæ°´ > 100ä¸‡ï¼‰
- ç‰¹æ®Šè¡Œä¸šï¼ˆæ•™è‚²ã€å…¬ç›Šç­‰ï¼‰
- æœ‰è®®ä»·èƒ½åŠ›çš„å¤§å®¢æˆ·

å¯èƒ½é™è‡³: 0.5% æˆ–æ›´ä½
```

### Q2: æ”¯ä»˜å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**ç­”ï¼šè‡ªåŠ¨é‡è¯•æœºåˆ¶**
```javascript
async function payWithRetry(params, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      return await WeChat.pay(params);
    } catch (error) {
      if (i === maxRetries - 1) throw error;
      await sleep(1000 * (i + 1)); // é€’å¢å»¶è¿Ÿ
    }
  }
}
```

### Q3: å¦‚ä½•å¤„ç†ä¸¢å•ï¼ˆç”¨æˆ·æ”¯ä»˜äº†ä½†æ²¡åˆ°è´¦ï¼‰ï¼Ÿ

**ç­”ï¼šä¸»åŠ¨æŸ¥è¯¢**
```javascript
// å®šæ—¶ä»»åŠ¡ï¼šæŸ¥è¯¢pendingè¶…è¿‡10åˆ†é’Ÿçš„è®¢å•
async function checkPendingOrders(env) {
  const pendingOrders = await env.DB.prepare(`
    SELECT * FROM orders 
    WHERE status = 'PENDING' 
    AND created_at < datetime('now', '-10 minutes')
  `).all();

  for (const order of pendingOrders.results) {
    // è°ƒç”¨å¾®ä¿¡æŸ¥è¯¢API
    const result = await queryWechatOrder(order.order_id, env);
    
    if (result.trade_state === 'SUCCESS') {
      // è¡¥å•
      await handlePaymentSuccess(order, env);
    }
  }
}
```

---

## åã€æ€»ç»“

### âœ… å®Œæ•´æµç¨‹

```
1. ç”³è¯·å¾®ä¿¡æ”¯ä»˜å•†æˆ·å·
   â””â”€ 1-5ä¸ªå·¥ä½œæ—¥

2. å‰ç«¯é›†æˆ
   â””â”€ react-native-wechat-lib

3. åç«¯å®ç°
   â””â”€ åˆ›å»ºè®¢å• + å›è°ƒå¤„ç†

4. æµ‹è¯•
   â””â”€ æ²™ç®±ç¯å¢ƒæµ‹è¯•

5. ä¸Šçº¿
   â””â”€ æ­£å¼ç¯å¢ƒ
```

### ğŸ’° æˆæœ¬

```
å¾®ä¿¡æ”¯ä»˜è´¹ç”¨:
- æ‰‹ç»­è´¹: 0.6% per transaction
- æç°è´¹: å…è´¹ï¼ˆT+1è‡ªåŠ¨åˆ°è´¦ï¼‰

å¹´åº¦æˆæœ¬ä¼°ç®—ï¼ˆ1000ç”¨æˆ·ï¼Œ50%ä»˜è´¹ï¼‰:
- 500ç”¨æˆ· Ã— Â¥99 = Â¥49,500
- æ‰‹ç»­è´¹: Â¥49,500 Ã— 0.6% = Â¥297
- å‡€æ”¶å…¥: Â¥49,203
```

### ğŸ¯ æ¨èå®šä»·

```
ä¸»æ¨: å¹´åº¦ä¼šå‘˜ Â¥99
å¤‡é€‰: æœˆåº¦ä¼šå‘˜ Â¥12
æŒ‰éœ€: é¢åº¦åŒ… Â¥9.9 / Â¥39.9

å…è´¹ç‰ˆ: æ¯æœˆ3æ¬¡ï¼Œå¼•å¯¼å‡çº§
```

### ğŸ“‹ å¼€å‘æ—¶é—´

```
Week 1: ç”³è¯·å•†æˆ·å·ï¼ˆç­‰å¾…å®¡æ ¸ï¼‰
Week 2: å‰ç«¯é›†æˆæµ‹è¯•
Week 3: åç«¯å¼€å‘æµ‹è¯•
Week 4: è”è°ƒä¸Šçº¿

æ€»è®¡: çº¦1ä¸ªæœˆ
```

**å‡†å¤‡å¥½å¼€å§‹é›†æˆäº†å—ï¼Ÿ** ğŸ’³

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**æœ€åæ›´æ–°ï¼š** 2025-06-01  
**ç»“è®ºï¼šå¾®ä¿¡æ”¯ä»˜æ˜¯ä¸­å›½å¸‚åœºçš„æœ€ä½³æ”¶è´¹æ–¹æ¡ˆ**

---

END OF DOCUMENT
